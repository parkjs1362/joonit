---
title: "Nightly Cleanup을 안전하게 운영하는 법: Report → Apply 2단계"
description: "야간 정리는 편리하지만 한 번의 오작동이 큽니다. Report와 Apply를 분리하는 안전모드 운영 패턴을 정리합니다."
date: "2026-02-17"
category: "개발"
tags: ["nightly-cleanup", "안전모드", "운영", "자동화"]
---

정리 자동화는 시간 절약 효과가 크지만, 잘못 설계하면 데이터 신뢰를 잃습니다.  
특히 삭제나 이동이 포함되면 “빠른 자동화”보다 “안전한 자동화”가 먼저입니다.

제가 정리 루틴에서 유지하는 원칙은 하나입니다.  
**실행 전에 반드시 리포트를 본다.**

## 1) Report와 Apply를 기능이 아니라 단계로 본다

많은 자동화가 report-only를 옵션으로만 둡니다.  
하지만 운영 관점에서는 옵션이 아니라 단계입니다.

- 1단계 Report: 무엇이 바뀔지 확인
- 2단계 Apply: 확인한 항목만 실제 반영

이 단계 분리가 있으면 실수는 줄고, 복구도 쉬워집니다.

## 2) 리포트에서 반드시 보는 항목

리포트가 길어도 아래 4개만 먼저 보면 됩니다.

- 대상 개수(몇 개가 처리되는가)
- 위험 파일(중요 경로가 포함되는가)
- 예외 패턴(평소와 다른 유형이 있는가)
- 마지막 실행 이후 변화량

핵심은 “정리량”보다 “예상 밖 변화”를 찾는 것입니다.

## 3) 스케줄 실행은 기본값을 보수적으로 둔다

야간 스케줄은 사람이 자는 시간에 돌아갑니다.  
그래서 기본 동작은 항상 보수적이어야 합니다.

권장 기본값은 아래처럼 고정합니다.

- 스케줄: report-only
- 수동 실행: apply
- 예외 발생: 즉시 중단 + 로그 남김

즉, 자동은 보고까지만, 반영은 사람이 결정합니다.

## 4) 실패보다 무음 성공을 경계한다

진짜 위험한 경우는 실패가 아니라 “조용히 잘 된 것처럼 보이는 실행”입니다.  
그래서 결과 로그에는 항상 아래가 남아야 합니다.

- 처리 건수
- 스킵 건수
- 예외 건수
- 출력 파일 경로

로그가 명확하면 다음날 아침 점검도 1분 안에 끝납니다.

## 체크리스트

- report-only와 apply를 물리적으로 분리했는가
- 스케줄 실행 기본값이 report-only인가
- 리포트에서 위험 파일/예외 패턴을 먼저 보는가
- 실행 결과에 처리/스킵/예외가 모두 기록되는가

## 오늘의 메모

정리 자동화의 품질은 “얼마나 지웠는가”가 아니라  
“얼마나 안전하게 지웠는가”로 판단해야 합니다.
