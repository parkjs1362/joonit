---
title: Docker 개발 환경 구축 가이드
description: Docker를 활용해 일관된 개발 환경을 구축하는 방법을 실제 예제와 함께 설명합니다.
date: '2025-02-13'
category: 개발
tags:
  - Docker
  - DevOps
  - 개발환경
draft: true
---
## Docker를 사용하는 이유

"내 컴퓨터에서는 됐는데?" 이 말을 더 이상 할 필요가 없어집니다. Docker는 애플리케이션과 그 의존성을 컨테이너로 패키징하여 어디서든 동일하게 실행할 수 있게 해줍니다.

## 핵심 개념

### 이미지와 컨테이너

- **이미지**: 컨테이너를 만들기 위한 읽기 전용 템플릿
- **컨테이너**: 이미지를 기반으로 실행되는 격리된 프로세스

```bash
# 이미지 기반으로 컨테이너 실행
docker run -d -p 3000:3000 --name my-app node:20-alpine
```

### Dockerfile

애플리케이션을 이미지로 만드는 설명서입니다:

```dockerfile
# Node.js 애플리케이션 Dockerfile
FROM node:20-alpine AS base

WORKDIR /app

# 의존성 먼저 설치 (캐시 레이어 활용)
COPY package.json package-lock.json ./
RUN npm ci

# 소스 코드 복사
COPY . .

# 프로덕션 빌드
RUN npm run build

# 실행 스테이지
FROM node:20-alpine AS runner
WORKDIR /app
COPY --from=base /app/.next ./.next
COPY --from=base /app/node_modules ./node_modules
COPY --from=base /app/package.json ./

EXPOSE 3000
CMD ["npm", "start"]
```

멀티 스테이지 빌드를 사용하면 최종 이미지 크기를 크게 줄일 수 있습니다.

## Docker Compose

여러 서비스를 한 번에 관리할 수 있습니다:

```yaml
# docker-compose.yml
services:
  app:
    build: .
    ports:
      - "3000:3000"
    environment:
      - DATABASE_URL=postgresql://user:pass@db:5432/mydb
    depends_on:
      - db
      - redis
    volumes:
      - ./src:/app/src  # 개발 시 핫 리로드

  db:
    image: postgres:16-alpine
    environment:
      POSTGRES_USER: user
      POSTGRES_PASSWORD: pass
      POSTGRES_DB: mydb
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data

  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"

volumes:
  postgres_data:
```

```bash
# 전체 서비스 시작
docker compose up -d

# 로그 확인
docker compose logs -f app

# 전체 중지
docker compose down
```

## 개발 환경 최적화

### 볼륨 마운트로 핫 리로드

개발 시 소스 코드를 볼륨으로 마운트하면 컨테이너를 재빌드하지 않아도 변경 사항이 반영됩니다:

```yaml
volumes:
  - ./src:/app/src
  - /app/node_modules  # node_modules는 컨테이너 것 사용
```

### .dockerignore 설정

불필요한 파일을 빌드 컨텍스트에서 제외합니다:

```
node_modules
.git
.next
*.md
.env.local
```

## 유용한 명령어

```bash
# 실행 중인 컨테이너 목록
docker ps

# 컨테이너 쉘 접속
docker exec -it my-app sh

# 사용하지 않는 리소스 정리
docker system prune -a

# 이미지 빌드 (캐시 무시)
docker build --no-cache -t my-app .
```

## 마무리

Docker는 개발 환경의 일관성을 보장하고, 배포 과정을 단순화하며, 마이크로서비스 아키텍처의 기반이 됩니다. Docker Compose로 데이터베이스, 캐시, 애플리케이션을 한 번에 관리하면 로컬 개발이 훨씬 편리해집니다. 처음에는 설정이 복잡해 보일 수 있지만, 한번 구축하면 팀 전체의 생산성이 크게 향상됩니다.
